var a;try{a=global.vscode||require("vscode")}catch{a={window:{showInformationMessage:()=>({dispose:()=>{}}),showErrorMessage:()=>({dispose:()=>{}}),showWarningMessage:()=>({dispose:()=>{}}),activeTextEditor:null,messages:[]},commands:{registerCommand:()=>{}},ExtensionContext:function(){}}}function d(e,r="info",n=3e3){let t;switch(r){case"error":t=a.window.showErrorMessage(e);break;case"warning":t=a.window.showWarningMessage(e);break;default:t=a.window.showInformationMessage(e)}return a.window.messages&&a.window.messages.push({message:e,type:r,timeout:n}),n>0&&t&&typeof t.dispose=="function"&&setTimeout(()=>{try{t.dispose()}catch{}},n),t}function w(e){let r=[],n="",t=!1,c=-1,s=0,l=!1,u=!1;for(let i=0;i<e.length;i++){let o=e[i];if(n+=o,u){u=!1;continue}if(o==="\\"){u=!0;continue}if(o==='"'||o==="'"){l=!l;continue}l||(o==="{"||o==="["?(s===0&&(c=i),s++,t=!0):(o==="}"||o==="]")&&(s--,s===0&&t&&(r.push({start:c,end:i+1,text:e.substring(c,i+1)}),t=!1))),(o===`
`||i===e.length-1)&&(n="")}if(r.length===0)return e;let f="",g=0;for(let i of r){f+=e.substring(g,i.start);try{let o=JSON.stringify(Function("return "+i.text)(),null,4);f+=o}catch{f+=i.text}g=i.end}return f+=e.substring(g),f}function m(e){return new Promise((r,n)=>{if(!e||!e.trim()){n(new Error("Invalid JSON: Empty input"));return}try{try{let t=JSON.parse(e);r(JSON.stringify(t,null,4));return}catch{try{let c=Function("return "+e)();r(JSON.stringify(c,null,4));return}catch{let s=w(e);if(s===e&&(e.includes("{")||e.includes("["))){n(new Error("Invalid JSON: Please check your syntax"));return}r(s);return}}}catch(t){n(t)}})}function p(e){if(!a||!a.commands)return;let r=a.commands.registerCommand("extension.formatJson",async function(){let n=a.window.activeTextEditor;if(!n){d("No active editor found","warning");return}let t=n.document,c=n.selection;if(c.isEmpty){let s=new a.Range(t.positionAt(0),t.positionAt(t.getText().length)),l=t.getText(s);if(!l.trim()){d("Document is empty","warning");return}try{let u=await m(l);await n.edit(f=>{f.replace(s,u)}),d("Document JSON formatted successfully")}catch(u){d(u.message,"error")}}else{let s=t.getText(c);if(!s.trim()){d("Selected text is empty","warning");return}try{let l=await m(s);await n.edit(u=>{u.replace(c,l)}),d("Selected JSON formatted successfully")}catch(l){d(l.message,"error")}}});e&&e.subscriptions&&e.subscriptions.push(r)}function h(){}module.exports={activate:p,deactivate:h,formatJson:m};
