var r;try{r=global.vscode||require("vscode")}catch{r={window:{showInformationMessage:()=>({dispose:()=>{}}),showErrorMessage:()=>({dispose:()=>{}}),showWarningMessage:()=>({dispose:()=>{}}),activeTextEditor:null,messages:[]},commands:{registerCommand:()=>{}},ExtensionContext:function(){}}}function a(t,i="info",o=3e3){let e;switch(i){case"error":e=r.window.showErrorMessage(t);break;case"warning":e=r.window.showWarningMessage(t);break;default:e=r.window.showInformationMessage(t)}return r.window.messages&&r.window.messages.push({message:t,type:i,timeout:o}),o>0&&e&&typeof e.dispose=="function"&&setTimeout(()=>{try{e.dispose()}catch{}},o),e}function d(t){return new Promise((i,o)=>{if(!t||!t.trim()){let e=new Error("Invalid JSON: Empty input");a(e.message,"error"),o(e);return}try{let e;try{e=JSON.parse(t)}catch{try{e=Function('"use strict";return ('+t+")")()}catch{throw new Error("Invalid JSON: Please check your syntax")}}let n=JSON.stringify(e,null,4);a("JSON formatted successfully"),i(n)}catch(e){a(e.message,"error"),o(e)}})}function w(t){if(!r||!r.commands)return;let i=r.commands.registerCommand("extension.formatJson",async function(){let o=r.window.activeTextEditor;if(!o){a("No active editor found","warning");return}let e=o.document,n=o.selection,c="";if(n.isEmpty){let s=new r.Range(e.positionAt(0),e.positionAt(e.getText().length));c=e.getText(s),n=new r.Selection(s.start,s.end)}else c=e.getText(n);if(!c.trim()){a("No text to format","warning");return}try{let s=await d(c);await o.edit(l=>{l.replace(n,s)})}catch(s){a(`Failed to format JSON: ${s.message}`,"error")}});t&&t.subscriptions&&t.subscriptions.push(i)}function f(){}module.exports={activate:w,deactivate:f,formatJson:d};
