var o;try{o=global.vscode||require("vscode")}catch{o={window:{showInformationMessage:()=>({dispose:()=>{}}),showErrorMessage:()=>({dispose:()=>{}}),showWarningMessage:()=>({dispose:()=>{}}),activeTextEditor:null,messages:[]},commands:{registerCommand:()=>{}},ExtensionContext:function(){}}}function c(t,i="info",r=3e3){let e;switch(i){case"error":e=o.window.showErrorMessage(t);break;case"warning":e=o.window.showWarningMessage(t);break;default:e=o.window.showInformationMessage(t)}return o.window.messages&&o.window.messages.push({message:t,type:i,timeout:r}),r>0&&e&&typeof e.dispose=="function"&&setTimeout(()=>{try{e.dispose()}catch{}},r),e}function d(t){return new Promise((i,r)=>{if(!t||!t.trim()){let e=new Error("Invalid JSON: Empty input");r(e);return}try{let e;try{e=JSON.parse(t)}catch{try{e=Function('"use strict";return ('+t+")")()}catch{throw new Error("Invalid JSON: Please check your syntax")}}let n=JSON.stringify(e,null,4);i(n)}catch(e){r(e)}})}function l(t){if(!o||!o.commands)return;let i=o.commands.registerCommand("extension.formatJson",async function(){let r=o.window.activeTextEditor;if(!r){c("No active editor found","warning");return}let e=r.document,n=r.selection,a="";if(n.isEmpty){let s=new o.Range(e.positionAt(0),e.positionAt(e.getText().length));a=e.getText(s),n=new o.Selection(s.start,s.end)}else a=e.getText(n);if(!a.trim()){c("No text to format","warning");return}try{let s=await d(a);await r.edit(w=>{w.replace(n,s)}),c("JSON formatted successfully")}catch(s){c(s.message,"error")}});t&&t.subscriptions&&t.subscriptions.push(i)}function u(){}module.exports={activate:l,deactivate:u,formatJson:d};
